---
import { format } from "date-fns";
import { Icon } from "astro-icon";

import MarkdownPostLayout from "../../layouts/MarkdownPostLayout.astro";
import { getCollection } from "astro:content";

import { slugToPath } from "../../libs/blog";
import siteMeta from "../../siteMeta";

export async function getStaticPaths() {
  const blogEntries = await getCollection("blog");
  return blogEntries.map((entry) => {
    const slug = slugToPath(entry.slug);
    return {
      params: { slug },
      props: { slug, entry },
    };
  });
}

const { slug, entry } = Astro.props;
const { Content } = await entry.render();
---

<MarkdownPostLayout title={`${entry.data.title} | ${siteMeta.siteName}`}>
  <div class="mb-12">
    <a class="no-underline" href={`/blog/${slug}`}>
      <h1 class="text-center">{entry.data.title}</h1>
    </a>
    <div class="flex justify-center items-center">
      <Icon name="mdi:calendar" size={21} />
      <p class="p-0 m-0">{format(entry.data.created_at, "yyyy/MM/dd")}</p>
    </div>
  </div>
  <Content />
</MarkdownPostLayout>
